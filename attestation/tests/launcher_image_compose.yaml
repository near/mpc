version: '3.8'

services:
  launcher:
    image: barakeinavnear/launcher@sha256:1ea7571baf18bd052359abd2a1f269e7836f9bad2270eb55fc9475aa327f8d96

 # isuse #531: TODO (security): Replace with a specific image digest
    container_name: launcher

    environment:
      - DOCKER_CONTENT_TRUST=1
      - DEFAULT_IMAGE_DIGEST=sha256:a87f7eb6882446dd714e6d47d9d1b9331cb333f36d3905f172c68adbd06e461f  # nearone/mpc-node-gcp:testnet-release

    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/run/dstack.sock:/var/run/dstack.sock
      - /tapp:/tapp:ro
      - shared-volume:/mnt/shared:ro

    security_opt:
      - no-new-privileges:true

    read_only: true

    tmpfs:
      - /tmp  # Required for many apps to function correctly when root FS is read-only

volumes:
  shared-volume:
    name: shared-volume